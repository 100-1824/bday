<div class="gallery-container">
    <a routerLink="/home" class="back-link">â† Back to Home</a>

    <header>
        <div class="header-content">
            <div class="header-text">
                <h1>Our Memories ğŸ“¸</h1>
                <p>Moments frozen in time</p>
            </div>
            <div class="header-actions">
                <app-upload-button *ngIf="activeTab === 'photos'" uploadType="gallery" fileType="image"
                    (uploadComplete)="onUploadComplete()"></app-upload-button>
                <app-upload-button *ngIf="activeTab === 'videos'" uploadType="gallery" fileType="video"
                    (uploadComplete)="onUploadComplete()"></app-upload-button>
            </div>
        </div>
    </header>

    <div class="tabs">
        <button [class.active]="activeTab === 'photos'" (click)="setTab('photos')">ğŸ“· Photos
            ({{images.length}})</button>
        <button [class.active]="activeTab === 'nails'" (click)="setTab('nails')">ğŸ’… Nails ({{nails.length}})</button>
        <button [class.active]="activeTab === 'videos'" (click)="setTab('videos')">ğŸ¬ Videos
            ({{videos.length}})</button>
    </div>

    <div class="loading" *ngIf="isLoading">
        <div class="spinner"></div>
        <p>Loading memories...</p>
    </div>

    <p class="error" *ngIf="error">{{ error }}</p>

    <div *ngIf="!isLoading && !error">
        <!-- Photos Tab - Masonry Layout -->
        <div class="media-grid" *ngIf="activeTab === 'photos'">
            <div class="photo-item" *ngFor="let img of images" (click)="openLightbox(img)">
                <img [src]="img" loading="lazy" alt="Memory">
                <button class="delete-btn" (click)="deleteItem(img, $event)">Ã—</button>
            </div>
            <p *ngIf="images.length === 0" class="empty-state">No photos found.</p>
        </div>

        <!-- Nails Tab - Masonry Layout -->
        <div class="media-grid nails-grid" *ngIf="activeTab === 'nails'">
            <div class="photo-item nail-item" *ngFor="let img of nails" (click)="openLightbox(img)">
                <img [src]="img" loading="lazy" alt="Nails">
                <button class="delete-btn" (click)="deleteItem(img, $event)">Ã—</button>
            </div>
            <p *ngIf="nails.length === 0" class="empty-state">
                No nail photos yet! ğŸ’…<br>
                <small>Move nail images to: <code>static/images/nails/</code></small>
            </p>
        </div>

        <!-- Videos Tab - Grid Layout -->
        <div class="video-grid" *ngIf="activeTab === 'videos'">
            <app-media-item *ngFor="let vid of videos" [videoUrl]="vid" (delete)="deleteItem(vid)"></app-media-item>
            <p *ngIf="videos.length === 0" class="empty-state">No videos found.</p>
        </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" [class.active]="lightboxOpen" (click)="closeLightbox()">
        <span class="lightbox-close">Ã—</span>
        <img [src]="lightboxImage" *ngIf="lightboxImage">
    </div>
</div>