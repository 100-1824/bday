<div class="home-container">
    <!-- Hero Section -->
    <section id="hero">
        <div class="hero-content">
            <h1>Happy Birthday, <span class="highlight">{{ herName }}</span></h1>
            <p class="subtitle">Welcome to your special surprise ğŸ’œ</p>
        </div>
    </section>

    <!-- Reasons I Love You Section -->
    <section id="reasons" class="container">
        <h2 class="section-title">Reasons I Love You ğŸ’•</h2>
        <div class="reason-card-container">
            <button class="nav-btn prev" (click)="prevReason()">â€¹</button>
            <div class="reason-card" [class.flipping]="isFlipping">
                <div class="reason-emoji">{{ currentReason.emoji }}</div>
                <p class="reason-text">{{ currentReason.text }}</p>
                <div class="reason-counter">{{ currentReasonIndex + 1 }} / {{ reasons.length }}</div>
            </div>
            <button class="nav-btn next" (click)="nextReason()">â€º</button>
        </div>
        <p class="tap-hint">â† Tap arrows to see more â†’</p>
    </section>

    <!-- Map Section -->
    <section id="connection-map" class="container">
        <h2 class="section-title">Connected by Love</h2>
        <div id="map-wrapper">
            <div id="map"></div>
        </div>
        <p class="distance-text">From my heart to yours, across any distance ğŸ’œ</p>
    </section>

    <!-- Letter Section -->
    <section id="love-letter" class="container">
        <h2 class="section-title">Special Deliveries ğŸ’Œ</h2>

        <div class="letters-container">
            <!-- Main Letter Envelope -->
            <div class="letter-item">
                <div class="envelope-container" (click)="toggleEnvelope('main')">
                    <div class="envelope" [class.open]="isEnvelopeOpen && activeLetterType === 'main'">
                        <div class="flap"></div>
                        <div class="letter">
                            <div class="letter-text">Birthday Wish...</div>
                        </div>
                        <div class="pocket"></div>
                    </div>
                </div>
                <p class="instruction-text">For My Birthday Girl ğŸ’œ</p>
            </div>

            <!-- Handwritten Letter Envelope -->
            <div class="letter-item">
                <div class="envelope-container" (click)="toggleEnvelope('handwritten')">
                    <div class="envelope" [class.open]="isEnvelopeOpen && activeLetterType === 'handwritten'">
                        <div class="flap" style="border-top-color: #7b1fa2;"></div>
                        <div class="pocket"
                            style="border-left-color: #9c27b0; border-right-color: #9c27b0; border-bottom-color: #8e24aa;">
                        </div>
                        <div class="letter">
                            <div class="letter-text">Handwritten...</div>
                        </div>
                    </div>
                </div>
                <p class="instruction-text">A Handwritten Note ğŸ“</p>
            </div>

            <!-- Voice Note 1 -->
            <div class="letter-item">
                <div class="voice-note-card" [class.playing]="playingVoiceNote === 1">
                    <button class="play-btn" (click)="toggleVoiceNote(1)">
                        <span *ngIf="playingVoiceNote !== 1">â–¶</span>
                        <span *ngIf="playingVoiceNote === 1">â¸</span>
                    </button>
                    <div class="voice-info">
                        <span class="voice-title">Voice Note 1 ğŸ™ï¸</span>
                        <span class="voice-status" *ngIf="playingVoiceNote === 1">Playing...</span>
                    </div>
                </div>
            </div>

            <!-- Voice Note 2 -->
            <div class="letter-item">
                <div class="voice-note-card" [class.playing]="playingVoiceNote === 2">
                    <button class="play-btn" (click)="toggleVoiceNote(2)">
                        <span *ngIf="playingVoiceNote !== 2">â–¶</span>
                        <span *ngIf="playingVoiceNote === 2">â¸</span>
                    </button>
                    <div class="voice-info">
                        <span class="voice-title">Voice Note 2 ğŸ™ï¸</span>
                        <span class="voice-status" *ngIf="playingVoiceNote === 2">Playing...</span>
                    </div>
                </div>
            </div>

            <!-- Record Your Own -->
            <div class="letter-item full-width">
                <div class="recorder-card">
                    <h3>Record a Message ğŸ¤</h3>
                    <div class="recorder-controls">
                        <button class="record-btn" *ngIf="!isRecording && !recordedBlob" (click)="startRecording()">
                            ğŸ”´ Record
                        </button>
                        <button class="stop-btn" *ngIf="isRecording" (click)="stopRecording()">
                            â¹ Stop
                        </button>

                        <div *ngIf="recordedBlob" class="recording-actions">
                            <audio [src]="recordedAudioUrl" controls class="preview-audio"></audio>
                            <div class="action-buttons">
                                <button class="save-btn" (click)="uploadRecording()" [disabled]="isUploading">
                                    {{ isUploading ? 'Saving...' : 'ğŸ’¾ Save' }}
                                </button>
                                <button class="discard-btn" (click)="discardRecording()" [disabled]="isUploading">
                                    ğŸ—‘ Discard
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Letter Overlay with Confetti -->
    <div class="letter-overlay" [class.active]="showLetterOverlay" (click)="closeLetterOverlay()">
        <!-- Confetti -->
        <div class="confetti-container" *ngIf="showLetterOverlay">
            <div class="confetti" *ngFor="let i of confettiPieces" [style.left.%]="i.left"
                [style.animation-delay.s]="i.delay" [style.background]="i.color"></div>
        </div>

        <!-- Sparkles -->
        <div class="sparkle" *ngFor="let s of sparkles" [style.left.%]="s.left" [style.top.%]="s.top"
            [style.animation-delay.s]="s.delay">âœ¨</div>

        <div class="paper" (click)="$event.stopPropagation()">
            <div class="birthday-header">ğŸ‚ Happy Birthday! ğŸ‚</div>

            <ng-container *ngIf="activeLetterType === 'main'">
                <h2>My Beautiful Blessed Suvi,</h2>
                <p style="white-space: pre-line">{{ letterContent }}</p>
            </ng-container>

            <ng-container *ngIf="activeLetterType === 'handwritten'">
                <h2>My Dearest Love,</h2>
                <p style="white-space: pre-line">{{ handwrittenText }}</p>
                <div class="hearts-footer">
                    <button class="view-original-btn" (click)="toggleHandwrittenLetter()">
                        ğŸ“œ View Original Letter
                    </button>
                </div>
            </ng-container>

            <div class="hearts-footer">ğŸ’œğŸ’œğŸ’œ</div>
            <button class="close-btn" (click)="closeLetterOverlay()">Ã—</button>
        </div>
    </div>

    <!-- Handwritten Letter Modal -->
    <div class="handwritten-modal" *ngIf="showHandwrittenLetter" (click)="toggleHandwrittenLetter()">
        <div class="modal-content" (click)="$event.stopPropagation()">
            <img src="assets/letters/handwritten.png" alt="Handwritten Letter" class="handwritten-img">
            <button class="close-modal-btn" (click)="toggleHandwrittenLetter()">Ã—</button>
        </div>
    </div>

    <!-- Navigation Cards -->
    <div class="navigation-links">
        <a routerLink="/gallery" class="nav-card">
            <h3>ğŸ“¸ Our Memories</h3>
            <p>Photos & Videos together</p>
        </a>
        <a routerLink="/notes" class="nav-card">
            <h3>ğŸ’œ Our Journal</h3>
            <p>Sweet notes & letters</p>
        </a>
        <a routerLink="/inspiration" class="nav-card">
            <h3>âœ¨ Faith & Vision</h3>
            <p>Boards & Verses</p>
        </a>
        <a routerLink="/private" class="nav-card private-card">
            <h3>ğŸ” Private</h3>
            <p>For your eyes only</p>
        </a>
    </div>
</div>